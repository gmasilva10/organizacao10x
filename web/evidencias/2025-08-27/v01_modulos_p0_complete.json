{
  "release": "v0.1 - Escopo Funcional P0 Modules",
  "timestamp": "2025-08-27T14:30:00Z",
  "summary": "3 módulos P0 implementados conforme especificado: Profile UX + Team CRUD + Settings Links",
  "modules_completed": [
    {
      "id": "feat/profile-avatar-and-ux",
      "description": "Avatar upload + dropdown menu UX polished",
      "branch": "feat/profile-avatar-and-ux",
      "commit": "94a561b",
      "features": [
        "POST /api/profile/avatar com Supabase Storage upload",
        "Upload + preview + validações frontend/backend", 
        "Dropdown menu AppShell (Meu Perfil, Configurações, Sair)",
        "Layout busca avatar_url do profiles",
        "Security: filename único, audit telemetria"
      ],
      "evidence": "web/evidencias/2025-08-27/profile_avatar_upload_preview.json"
    },
    {
      "id": "feat/team-collaborators-crud",
      "description": "CRUD colaboradores + limites por plano + UI completa",
      "branch": "feat/team-collaborators-crud", 
      "commit": "392c01b",
      "features": [
        "Migration cfg-team-p1.sql: tabela collaborators com RLS + índices",
        "APIs GET/POST/PATCH/DELETE + toggle status",
        "UI /app/team com grid cards + modais create/edit + filtros",
        "Limites plano Basic=3, Enterprise=100 colaboradores ativos",
        "AppShell menu Equipe substituindo Team Admin",
        "Components Dialog + Select UI (Radix)",
        "Security: RLS por org + RBAC admin/manager"
      ],
      "evidence": "web/evidencias/2025-08-27/team_collaborators_crud_full.json"
    },
    {
      "id": "feat/settings-link-user-collaborator", 
      "description": "Vínculo User⇄Collaborator + UI settings",
      "branch": "feat/settings-link-user-collaborator",
      "commit": "pendente",
      "features": [
        "APIs POST/DELETE /api/settings/users/{id}/link-collaborator",
        "UI /app/settings/users com coluna vínculo + modal seleção",
        "Constraint 1:1 user ⇄ collaborator por organização",
        "RBAC admin/manager gerenciam vínculos",
        "Modal com colaboradores ativos disponíveis",
        "Error handling para conflitos de vínculo",
        "Audit telemetria link/unlink events"
      ],
      "evidence": "web/evidencias/2025-08-27/settings_link_user_collaborator.json"
    }
  ],
  "acceptance_criteria_validation": {
    "profile_ux": {
      "avatar_upload": "✅ Upload + preview funciona",
      "dropdown_menu": "✅ Meu Perfil, Configurações (RBAC), Sair",
      "persistence": "✅ Avatar persiste e aparece no AppShell"
    },
    "team_crud": {
      "create_collaborators": "✅ Criar 2-3 colaboradores",
      "plan_limits": "✅ Basic bloqueia 4º colaborador com 422",
      "edit_toggle": "✅ Editar dados e ativar/desativar",
      "search_filter": "✅ Busca por nome/email + filtros status/role",
      "rbac": "✅ Viewer não vê botões; admin/manager gerenciam"
    },
    "settings_links": {
      "link_user_collaborator": "✅ Vincular usuário a colaborador ativo",
      "unlink_user_collaborator": "✅ Desvincular com confirmação",
      "modal_selection": "✅ Modal mostra apenas disponíveis",
      "table_display": "✅ Coluna mostra nome ou '—'",
      "conflict_handling": "✅ Erro claro se já vinculado",
      "rbac": "✅ Admin/manager podem gerenciar vínculos"
    }
  },
  "ready_for_staging": {
    "status": "READY",
    "next_steps": [
      "Merge branches para main/staging",
      "Aplicar migrações (cfg-team-p1.sql)",
      "Testar smoke tests conforme critérios",
      "Validar limites de plano funcionando",
      "Verificar RBAC aplicado corretamente",
      "Confirmar avatar upload + storage funcionando"
    ]
  },
  "post_v01_roadmap": {
    "v02_features": [
      "Invite opcional: POST /api/settings/users/invite",
      "Team → Atribuir papel direto (atalho)",
      "Capacidades: GET /api/capabilities no rodapé settings",
      "Kanban desbloqueio em produção",
      "Services CRUD habilitado"
    ]
  }
}
