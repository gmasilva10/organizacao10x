GUIA DE TESTE - VALIDAÇÃO COMPLETA DO SISTEMA

Objetivo: validar ponta-a-ponta todos os módulos, fluxos e regras de negócio em ambiente DEV (TZ America/Sao_Paulo), garantindo console limpo, RLS efetiva, reuso de serviços e baseline p95 sem regressão.

Pré-requisitos:
- Usuário padrão (Admin): email e senha já definidos.
- Navegador: janela anônima, sem extensões.
- Timezone do SO: America/Sao_Paulo.
- Console limpo (F12) o tempo todo; capturar prints quando indicado.
- Feature flag: Analytics OFF; Badge visível apenas em DEV (não em produção).

1) Login
1.1. Acessar /auth/login
1.2. Informar credenciais padrão; clicar Entrar
1.3. Esperado: redirecionar para Dashboard; console sem warnings/errors.

2) Módulo Serviços
2.1. Onboarding (Kanban)
- Acessar /app/onboarding
- Criar colunas: "Lead", "Contato", "Agendado", "Ativo", "Perdido" (ou equivalente do negócio)
- Criar tarefas exemplo por coluna (títulos curtos, descrição, responsável)
- Validar: drag-and-drop entre colunas; contadores por coluna; sem contadores redundantes no topo.
- Console deve permanecer limpo.

2.2. Relacionamento (Templates)
- Acessar /app/relationship/templates
- Criar templates:
  • MSG01: "Olá [PrimeiroNome], [SaudacaoTemporal]!"
  • MSG02: "Treino de hoje às [HoraTreino]. Tudo certo?"
- Validar: variáveis sempre entre colchetes; preview resolve variáveis; salvar/editar funciona; console limpo.

2.3. Ocorrências
- Acessar /app/incidents
- Listar grupos existentes; criar grupo novo "Financeiro"
- Dentro do grupo, criar tipo de ocorrência: "2ª via boleto" (campos: aluno, vencimento, observação)
- Validar: criar ocorrência; encerrar, concluir, cancelar, reagendar; visualizar histórico por aluno.

2.4. Anamnese
- Acessar /app/anamnesis
- Criar Template de Anamnese completo (perguntas obrigatórias e opcionais)
- Marcar como Padrão
- Criar Diretriz de Treino vinculada ao template (regras, catálogos, faixas de carga, frequência)
- Validar: aplicação da diretriz em um aluno; preview de regras; console limpo.

3) Módulo Equipe
- Acessar /app/team
- Validar perfis (Admin, Coach, Operacional) e permissões básicas
- Conferir profissionais cadastrados
- Validar Defaults (profissional padrão por módulo/ação)

4) Módulo Alunos
4.1. Cadastro completo
- Acessar /app/students → "+ Novo Aluno"
- Preencher dados: nome, email, telefone (+55 E.164 se aplicável), data nascimento, endereço
- Conferir defaults de profissionais aplicados
- Salvar; validar card na listagem

4.2. Anexos do aluno
- Abrir aluno → aba Anexos
- Upload de 1 arquivo; testar câmera se disponível
- Validar download/visualização

4.3. Processos do aluno (A-10.2.3)
- Abrir aluno → Editar → botão "Processos" (abre MessageComposer unificado)
- Validar (Composer único/reuso):
  • Acessos equivalentes disparam o MESMO componente:
    - Aluno › Processos
    - Relacionamento › + Nova Mensagem
    - Ocorrências › Enviar follow-up
    - Dashboard › Ação rápida
  • Evidência: print/record da rota/stack de abertura mostrando o mesmo componente.
- Validar funcionalidades:
  • Inserção de variável no caret: colocar cursor início e inserir [PrimeiroNome]
  • Prévia colapsada com variáveis resolvidas (catálogo NÃO abre junto ao clicar em "Ver Prévia")
  • DateTime picker pt-BR com OK/Enter/Esc; botões Hoje/Limpar
  • Enviar/Agendar WhatsApp com telefone normalizado (+55/E.164)
  • Deep-linking: toast "Ver Relacionamento" abre /app/relationship?focusTaskId=<id> com período correto
  • Reflexo imediato em Kanban/Calendário/Timeline
  • Console limpo; sem "Invalid time value"

5) Fluxo de Trabalho
5.1. Onboarding
- Confirmar aluno recém-criado presente no Onboarding (coluna adequada)
- Arrastar entre colunas simulando jornada do dia a dia
- Verificar se alguma tarefa do Onboarding cria mensagem (se previsto)

5.2. Relacionamento (A-10.2.4)
- Acessar /app/relationship
- Drawer de filtros: botão "Filtros" → abrir/fechar/aplicar/limpar
- Persistência: recarregar a página e conferir filtros salvos
- A11y: Esc fecha, focus retorna ao botão "Filtros"; focus inicial no primeiro campo
- Analytics OFF (apenas DEV): cartão informativo + badge; nada em produção
- Calendário padronizado: estilos iguais ao Composer; atalhos Enter/Esc
- Garantir que Kanban/Lista principal esteja acima da dobra (sem scroll inicial)

5.3. Gestão de Ocorrências
- Criar, encerrar, concluir, cancelar, reagendar ocorrências para o aluno
- Usar filtros do módulo; validar persistência quando aplicável

6) Regras técnicas transversais
- RLS multi-tenant: smoke em rotas de relacionamento/incidents; usuários de outro tenant devem receber 403/404 (incluir print das respostas 403/404 com headers mínimos, sem dados sensíveis)
- Reuso de serviços: MessageComposer único; endpoints não duplicados
- Data/hora: America/Sao_Paulo; formato DD/MM/YYYY HH:mm; sem Invalid time value
- Console: zero WARN/ERROR
- Performance: baseline p95 sem regressão (comparar antes/depois do drawer/calendário). Observação operacional: para evitar coluna "Enviadas" congelada com histórico longo, aplicar filtro de período adequado (evidência: print do filtro aplicado).

7) Coleta de Evidências (GIFs/Prints)
A-10.2.3 (Alunos › Processos):
- GIF A: Criar tarefa hoje 17:00 → entra em "Para Hoje" (EXCLUSIVO; não duplica em Pendente); Calendário hoje; toast deep-link com focusTaskId correto e período HOJE; foco no card ao abrir
- GIF B: Criar tarefa amanhã 09:00 → entra em "Pendente" (EXCLUSIVO; não duplica em Para Hoje); Calendário na data; Timeline registra; toast abre com período da data FUTURA; foco no card
- GIF C: Inserir [PrimeiroNome] no início → token no caret; "Ver Prévia" resolve variáveis; catálogo NÃO abre junto
- PRINTS: Console limpo; DateTime picker pt-BR com "OK" (Enter confirma, Esc fecha) e casos-limite: hoje 23:30, amanhã 00:05, fim de mês e 29/02 (ano bissexto) — sem "Invalid time value"

A-10.2.4 (Relacionamento):
- GIF 1: Drawer abrir/fechar/aplicar/limpar (persistência após reload)
- GIF 2: Navegação Kanban/Calendário após filtros (sem flicker)
- PRINT: A11y (Dialog/Drawer) sem warnings comuns

8) Hardening rápido (Relacionamento)
- Verificar 200/logs/refresh nas ações: mark sent, snooze +1/+3/+7, skip, delete (sem duplicar em Pendente/Para Hoje)
- Smoke RLS das rotas do relacionamento
- WhatsApp: texto resolvido e telefone normalizado (E.164/+55)
  • Casos de teste: número com +55 e DDD sem máscara; número com espaços/hífens; número sem +55 (aplicar normalização). Evidência: print do link gerado (URI-safe) e WhatsApp abrindo com a mensagem resolvida.

9) Critérios de aceite finais
- Todos os GIFs e prints anexados nos arquivos de evidência
- Reuso de serviços confirmado (1 Composer, endpoints únicos)
- p95 baseline mantido; console limpo; a11y mínima OK

Observações:
- Nunca exibir badge de Analytics OFF em produção.
- Em caso de erro, registrar print e passo para reprodução.
