# üìã PEND√äNCIAS OUTUBRO 2025
**Data de Cria√ß√£o:** 30/09/2025  
**V√°lido para:** Outubro/2025  
**Respons√°vel:** Dev Team  

---

## üéØ RESUMO EXECUTIVO

Este documento consolida TODAS as pend√™ncias identificadas no projeto Organizacao10x para serem atacadas em outubro/2025. Itens organizados por prioridade (P0-P3) e categoria.

**Total de Itens:** 47 pend√™ncias  
**Cr√≠ticas (P0):** 8 itens  
**Altas (P1):** 15 itens  
**M√©dias (P2):** 14 itens  
**Baixas (P3):** 10 itens  

---

## üî• P0 - CR√çTICO (SEGURAN√áA E BLOCKERS)

### üîí SEGURAN√áA

- [ ] **P0.1** - Remover segredos do VCS (`.env.local` raiz e `web/.env.local`)
  - **Impacto:** Cr√≠tico - Chaves expostas publicamente
  - **Arquivos:** `.env.local`, `web/.env.local`, `web/Estrutura/Credenciais_QA_Supabase.txt`
  - **A√ß√£o:** `git rm --cached`, adicionar ao `.gitignore`, rotacionar chaves

- [ ] **P0.2** - Rotacionar chaves Supabase (ANON + SERVICE_ROLE)
  - **Impacto:** Cr√≠tico - Prevenir acesso n√£o autorizado
  - **Local:** Supabase Dashboard ‚Üí Settings ‚Üí API
  - **A√ß√£o:** Gerar novas chaves, atualizar vari√°veis de ambiente

- [ ] **P0.3** - Rotacionar tokens Z-API (INSTANCE_TOKEN + CLIENT_TOKEN)
  - **Impacto:** Cr√≠tico - Prevenir uso indevido da API WhatsApp
  - **Local:** Z-API Dashboard
  - **A√ß√£o:** Gerar novos tokens, atualizar env

- [ ] **P0.4** - Bloquear/Remover endpoint `api/debug/execute-sql`
  - **Impacto:** Cr√≠tico - Execu√ß√£o arbitr√°ria de SQL
  - **Arquivo:** `web/app/api/debug/execute-sql/route.ts`
  - **A√ß√£o:** Deletar OU colocar atr√°s de role check + feature flag

- [ ] **P0.5** - Remover tokens hardcoded em `api/wa/test-zapi`
  - **Impacto:** Cr√≠tico - Tokens em c√≥digo-fonte
  - **Arquivo:** `web/app/api/wa/test-zapi/route.ts`
  - **A√ß√£o:** Deletar arquivo OU usar env vars

- [ ] **P0.6** - Remover `debug-migration.html` do frontend
  - **Impacto:** Alto - Opera√ß√µes admin expostas
  - **Arquivo:** `web/debug-migration.html`
  - **A√ß√£o:** `git rm web/debug-migration.html`

### üßπ HIGIENE CR√çTICA

- [ ] **P0.7** - Remover artefatos de build do VCS
  - **Impacto:** Alto - Reposit√≥rio polu√≠do, builds lentos
  - **Arquivos:** `web/.next/`, `web/coverage/`, `web/lighthouse-report.json`, `web/tsconfig.tsbuildinfo`
  - **A√ß√£o:** `git rm -r --cached`, adicionar ao `.gitignore`

- [ ] **P0.8** - Limpar arquivos "lixo" da raiz
  - **Impacto:** M√©dio - Polui√ß√£o do repo
  - **Arquivos:** `o  Select-String...`, `tatus`, `u√°rios an√¥nimos`, etc.
  - **A√ß√£o:** Deletar arquivos corrompidos/tempor√°rios

---

## ‚ö†Ô∏è P1 - ALTA PRIORIDADE (QUALIDADE E FUNCIONALIDADE)

### üé® M√ìDULO RELACIONAMENTO

- [ ] **P1.1** - Validar Checklist de Relacionamento (9 crit√©rios)
  - **Impacto:** Alto - Gate 10.7 pendente de valida√ß√£o
  - **Documento:** `Checklist_Release_Validation.txt`
  - **Crit√©rios:**
    - CA-01: Filtro Padr√£o "Hoje"
    - CA-02: Filtro Futuro (100% Futuro)
    - CA-03: Filtro Passado
    - CA-04: Intervalo Cruzando Passado/Hoje/Futuro
    - CA-05: Adiar Tarefa (1/3/7 dias)
    - CA-06: Marcar como Enviada
    - CA-07: Pular Tarefa com Undo
    - CA-08: Excluir Tarefa com Undo
    - CA-09: Ordena√ß√£o e Contadores

- [ ] **P1.2** - Corrigir bugs do Drawer de Filtros (Relacionamento)
  - **Impacto:** Alto - Filtros n√£o funcionam corretamente
  - **Problemas:**
    - Calend√°rio transparente dentro do Drawer
    - Filtros n√£o aplicam ao clicar "Aplicar"
    - Encoding de caracteres especiais (Per√≠odo ‚Üí Per√É¬≠odo)
  - **Arquivo:** `web/components/relationship/RelationshipKanban.tsx`

- [ ] **P1.3** - Corrigir calend√°rio transparente em modais
  - **Impacto:** Alto - UX quebrada
  - **Componente:** `StandardizedCalendar` dentro de `Dialog/Drawer`
  - **Arquivos:** `web/components/ui/popover.tsx`, `web/components/ui/standardized-calendar.tsx`

- [ ] **P1.4** - Implementar autentica√ß√£o real nas APIs de Relacionamento
  - **Impacto:** Alto - Seguran√ßa
  - **TODOs encontrados:**
    - `web/app/api/relationship/tasks/route.ts` (linhas 26, 205)
    - `web/app/api/relationship/tasks/[id]/route.ts` (linha 119)
    - `web/app/api/relationship/tasks/[id]/undo/route.ts` (linha 120)
  - **A√ß√£o:** Substituir `'dev-user-id'` por `ctx.userId` real

### üí∞ M√ìDULO FINANCEIRO

- [ ] **P1.5** - Implementar CRUD de Categorias Financeiras
  - **Impacto:** M√©dio - Subm√≥dulo incompleto
  - **Arquivo:** `web/components/services/CategoryManager.tsx` (atualmente mock)
  - **Funcionalidades:**
    - Criar categoria
    - Editar categoria (nome, cor, status)
    - Deletar categoria
    - Listar categorias
  - **API:** Criar endpoints `/api/financial/categories`

- [ ] **P1.6** - Migra√ß√£o: Tabela `financial_categories`
  - **Impacto:** M√©dio - Suporte ao CRUD de categorias
  - **Arquivo:** `supabase/migrations/YYYYMMDD_financial_categories.sql`
  - **Colunas:** `id`, `name`, `color`, `active`, `org_id`, `created_at`, `updated_at`

### üèóÔ∏è ESTRUTURA E CONSIST√äNCIA

- [ ] **P1.7** - Consolidar estrutura de rotas: `app/(app)` vs `app/app`
  - **Impacto:** Alto - Duplica√ß√£o e confus√£o
  - **Decis√£o:** Manter `app/(app)` como padr√£o
  - **A√ß√£o:** Migrar conte√∫do de `app/app` para `app/(app)` e deletar `app/app`

- [ ] **P1.8** - Padronizar nomenclatura: `relationship` vs `relacionamento`
  - **Impacto:** Alto - Inconsist√™ncia cr√≠tica
  - **Decis√£o:** Escolher um idioma (pt-BR OU en)
  - **Arquivos afetados:** `web/app/(app)/app/relationship` vs `web/app/(app)/app/relacionamento`
  - **Recomenda√ß√£o:** Manter `relationship` (ingl√™s, padr√£o de c√≥digo)

- [ ] **P1.9** - Padronizar nomenclatura: `anamnese` vs `anamnesis`
  - **Impacto:** Alto - Inconsist√™ncia cr√≠tica
  - **Arquivos afetados:** `web/components/anamnese/` vs `web/components/anamnesis/`
  - **Recomenda√ß√£o:** Manter `anamnesis` (ingl√™s)

- [ ] **P1.10** - Unificar componente `EmptyState`
  - **Impacto:** M√©dio - Duplica√ß√£o, risco de conflito cross-OS
  - **Arquivos:** `web/components/ui/EmptyState.tsx` vs `web/components/ui/empty-state.tsx`
  - **A√ß√£o:** Manter apenas `empty-state.tsx`, ajustar imports

- [ ] **P1.11** - Remover `web/web/` redundante
  - **Impacto:** M√©dio - Aninhamento desnecess√°rio
  - **A√ß√£o:** Mover conte√∫do de `web/web/evidencias/` para `web/evidencias/`, deletar `web/web/`

### ‚úÖ TIPAGEM E QUALIDADE

- [ ] **P1.12** - Substituir `any` por tipos expl√≠citos
  - **Impacto:** Alto - Type safety
  - **Arquivos com `any` excessivo (109 ocorr√™ncias em 55 arquivos):**
    - `web/app/students/[id]/anamnese/[versionId]/page.tsx`
    - `web/app/p/anamnese/[token]/page.tsx`
    - Rotas `api/occurrences/*`
  - **A√ß√£o:** Criar types compartilhados, usar Zod schemas

- [ ] **P1.13** - Configurar ESLint: `no-console`, `no-explicit-any`
  - **Impacto:** Alto - Padr√£o de c√≥digo
  - **Arquivo:** `web/.eslintrc.json`
  - **Regras:**
    ```json
    {
      "rules": {
        "no-console": ["warn", { "allow": ["warn", "error"] }],
        "@typescript-eslint/no-explicit-any": "error",
        "@typescript-eslint/no-floating-promises": "error"
      }
    }
    ```

- [ ] **P1.14** - Remover `console.log` em produ√ß√£o
  - **Impacto:** M√©dio - Performance, seguran√ßa
  - **Arquivos afetados:** `web/middleware.ts`, `web/utils/supabase/server.ts`, v√°rias rotas `api/*`
  - **A√ß√£o:** Substituir por logger com n√≠veis (debug/info/warn/error)

- [ ] **P1.15** - Corrigir testes unit√°rios quebrados
  - **Impacto:** M√©dio - CI/CD
  - **Arquivo:** `__tests__/unit/components/presentational/confirm-dialog-view-accessibility.test.tsx`
  - **Problema:** Refer√™ncia a fonte inexistente
  - **A√ß√£o:** Restaurar componente OU atualizar caminho do teste

---

## üìä P2 - M√âDIA PRIORIDADE (MELHORIAS E REFINAMENTO)

### üóÉÔ∏è MIGRATIONS E BANCO

- [ ] **P2.1** - Padronizar migrations: `YYYYMMDD__descricao.sql`
  - **Impacto:** M√©dio - Organiza√ß√£o
  - **Problema:** Nomenclaturas mistas, duplica√ß√µes (`his01_audit_log.sql` vs `his01_audit_log_p0.sql`)
  - **A√ß√£o:** Renomear migrations antigas, criar CHANGELOG

- [ ] **P2.2** - Consolidar migrations duplicadas
  - **Impacto:** M√©dio - Evitar conflitos
  - **Arquivos:** `his01_*` com varia√ß√µes p0/p1
  - **A√ß√£o:** Mesclar em uma √∫nica vers√£o can√¥nica

### üß™ TESTES E QA

- [ ] **P2.3** - Ampliar cobertura de testes para APIs
  - **Impacto:** M√©dio - Qualidade
  - **Foco:** Cen√°rios de erro (4xx, 5xx) para APIs cr√≠ticas
  - **M√≥dulos:** `api/relationship/*`, `api/students/*`, `api/occurrences/*`

- [ ] **P2.4** - Testes E2E do m√≥dulo Financeiro
  - **Impacto:** M√©dio - Valida√ß√£o de novo m√≥dulo
  - **Casos:** CRUD de Planos, CRUD de Categorias, Filtros

- [ ] **P2.5** - Smoke tests do m√≥dulo Relacionamento
  - **Impacto:** M√©dio - Valida√ß√£o p√≥s-refatora√ß√£o
  - **Casos:** Colunas din√¢micas, Filtros, A√ß√µes (adiar/pular/excluir/undo)

### üìö DOCUMENTA√á√ÉO

- [ ] **P2.6** - Atualizar README com m√≥dulo Financeiro
  - **Impacto:** Baixo - Documenta√ß√£o
  - **Arquivo:** `README.md`
  - **Conte√∫do:** Estrutura de subm√≥dulos (Planos + Categoria)

- [ ] **P2.7** - Criar evid√™ncias de mudan√ßas (GATE 10.8)
  - **Impacto:** Baixo - Governan√ßa
  - **Arquivo:** `web/evidencias/GATE_10.8_FINANCEIRO.md`
  - **Conte√∫do:** Cards compactos, subm√≥dulos, screenshots

- [ ] **P2.8** - Mover planilhas para `docs/`
  - **Impacto:** Baixo - Organiza√ß√£o
  - **Pasta:** `Planilha/` ‚Üí `docs/planilhas/`
  - **A√ß√£o:** Garantir que n√£o entram no bundle/deploy

### üîß REFATORA√á√ÉO

- [ ] **P2.9** - Remover vers√µes antigas de `StudentEditTabs` (V2-V5)
  - **Impacto:** Baixo - Limpeza de c√≥digo
  - **Arquivos:** `web/components/students/StudentEditTabsV2..V5`
  - **A√ß√£o:** Confirmar que V6 est√° em uso, deletar V2-V5

- [ ] **P2.10** - Centralizar client Z-API
  - **Impacto:** M√©dio - Manutenibilidade
  - **Arquivo:** `web/src/server/zapi.ts`
  - **A√ß√£o:** Validar envs no startup, mascarar dados em logs

- [ ] **P2.11** - Extrair l√≥gicas pesadas para hooks/utilities
  - **Impacto:** M√©dio - Reusabilidade
  - **Foco:** Componentes `students/*` com l√≥gica complexa
  - **A√ß√£o:** Criar hooks personalizados tipados

### üé® UX E DESIGN

- [ ] **P2.12** - Empty states customizados por m√≥dulo
  - **Impacto:** Baixo - UX
  - **M√≥dulos:** Relacionamento (colunas vazias), Financeiro (sem categorias)
  - **A√ß√£o:** Mensagens espec√≠ficas e ilustra√ß√µes

- [ ] **P2.13** - Loading states padronizados
  - **Impacto:** Baixo - UX
  - **Componente:** Criar `LoadingSpinner` e `SkeletonCard` reutiliz√°veis
  - **Uso:** Substituir spinners inline

- [ ] **P2.14** - Toasts padronizados (success/error/info/warning)
  - **Impacto:** Baixo - Consist√™ncia
  - **Biblioteca:** Sonner (j√° em uso)
  - **A√ß√£o:** Criar wrapper com templates padr√£o

---

## üåü P3 - BAIXA PRIORIDADE (NICE TO HAVE)

### üöÄ PERFORMANCE

- [ ] **P3.1** - Bundle analysis e code splitting
  - **Impacto:** Baixo - Performance
  - **Ferramenta:** `@next/bundle-analyzer`
  - **A√ß√£o:** Identificar chunks grandes, fazer lazy loading

- [ ] **P3.2** - Implementar caching de queries (React Query)
  - **Impacto:** Baixo - Performance
  - **Biblioteca:** `@tanstack/react-query` (j√° configurado?)
  - **Foco:** Listas de alunos, tarefas, planos

### üîê AUTENTICA√á√ÉO E RBAC

- [ ] **P3.3** - OAuth Google
  - **Impacto:** Baixo - Feature adicional
  - **Provider:** Supabase Auth + Google
  - **A√ß√£o:** Configurar callback, UI de login

- [ ] **P3.4** - Ajustes finos em RBAC
  - **Impacto:** Baixo - Seguran√ßa adicional
  - **Foco:** Permissions granulares por m√≥dulo
  - **A√ß√£o:** Review de policies RLS

### üì± INTEGRA√á√ïES

- [ ] **P3.5** - Logs centralizados (Sentry/LogRocket)
  - **Impacto:** Baixo - Observabilidade
  - **Ferramenta:** Sentry para erros, LogRocket para sess√µes
  - **A√ß√£o:** Configurar SDK, mascarar dados sens√≠veis

- [ ] **P3.6** - Analytics e m√©tricas de uso
  - **Impacto:** Baixo - Insights
  - **Ferramenta:** Plausible/PostHog (privacy-friendly)
  - **A√ß√£o:** Track eventos cr√≠ticos (envio mensagens, cria√ß√£o planos)

### üé® DESIGN SYSTEM

- [ ] **P3.7** - √çcones e ilustra√ß√µes customizadas
  - **Impacto:** Baixo - Branding
  - **Ferramenta:** Figma + Lucide Icons
  - **A√ß√£o:** Substituir √≠cones gen√©ricos

- [ ] **P3.8** - SEO metadata por p√°gina
  - **Impacto:** Baixo - Discoverability (se for p√∫blico)
  - **Componente:** `<Head>` com title, description, og:image
  - **A√ß√£o:** Adicionar metadata em `layout.tsx` de cada rota

### üåç ACESSIBILIDADE

- [ ] **P3.9** - Suporte a teclado (navega√ß√£o completa)
  - **Impacto:** Baixo - A11y
  - **Foco:** Kanban, Dropdowns, Modais
  - **A√ß√£o:** Testar com Tab, Enter, Esc, Arrow keys

- [ ] **P3.10** - Leitores de tela (ARIA completo)
  - **Impacto:** Baixo - A11y
  - **Ferramenta:** NVDA/VoiceOver
  - **A√ß√£o:** Validar `aria-*` attributes em todos os componentes

---

## üìù NOTAS ADICIONAIS

### TODOs Encontrados no C√≥digo (Alta Prioridade)

```typescript
// web/app/api/relationship/tasks/[id]/undo/route.ts:120
undo_performed_by: 'dev-user-id', // TODO: pegar do contexto de autentica√ß√£o

// web/app/api/relationship/tasks/route.ts:26, 205
// TODO: Implementar autentica√ß√£o real em produ√ß√£o

// web/app/api/relationship/tasks/[id]/route.ts:119
deleted_by: 'dev-user-id' // TODO: usar userId real
```

### Depend√™ncias de GATE 10.7 (Relacionamento)

- Valida√ß√£o do Checklist √© **bloqueador** para considerar o m√≥dulo conclu√≠do
- Bugs de filtros/calend√°rio afetam UX cr√≠tica
- Sem autentica√ß√£o real, as APIs s√£o inseguras

### Depend√™ncias de GATE 10.8 (Financeiro)

- Category Manager precisa de CRUD completo antes de considerar o m√≥dulo pronto
- Migra√ß√£o de banco √© **bloqueador** para o CRUD

---

## ‚úÖ CRIT√âRIOS DE CONCLUS√ÉO

Este documento ser√° considerado **100% conclu√≠do** quando:

1. **Todos os P0** estiverem resolvidos (seguran√ßa cr√≠tica)
2. **80%+ dos P1** estiverem resolvidos (qualidade e funcionalidade)
3. **M√≥dulo Relacionamento** validado com Checklist completo
4. **M√≥dulo Financeiro** com CRUD de Categorias funcional
5. **Estrutura de pastas** consolidada (sem duplica√ß√µes pt/en)
6. **Testes** passando (CI verde)

---

## üìÖ CRONOGRAMA SUGERIDO (OUTUBRO)

### Semana 1 (01-06/10)
- P0.1 a P0.8 (Seguran√ßa e Higiene)
- P1.1 (Validar Checklist Relacionamento)
- P1.7 a P1.11 (Estrutura e Consist√™ncia)

### Semana 2 (07-13/10)
- P1.2 a P1.4 (Bugs Relacionamento)
- P1.5 a P1.6 (Financeiro - Categorias)
- P1.12 a P1.15 (Tipagem e Qualidade)

### Semana 3 (14-20/10)
- P2.1 a P2.5 (Migrations e Testes)
- P2.6 a P2.8 (Documenta√ß√£o)
- P2.9 a P2.14 (Refatora√ß√£o e UX)

### Semana 4 (21-27/10)
- P3.1 a P3.10 (Nice to Have - conforme tempo dispon√≠vel)
- Code review geral
- Valida√ß√£o final

### Buffer (28-31/10)
- Corre√ß√µes de √∫ltima hora
- Documenta√ß√£o de lan√ßamento
- Prepara√ß√£o para novembro

---

## üîó REFER√äNCIAS

- `Checklist_Release_Validation.txt` - 9 crit√©rios GATE 10.7
- `RELATORIO_QUALIDADE.md` - Auditoria completa (24/09/2025)
- `Atividades.txt` - Hist√≥rico de desenvolvimento
- `web/Estrutura/Pendencias*.txt` - Backlog antigo
- C√≥digo-fonte: 109 TODOs encontrados em 55 arquivos

---

**√öltima Atualiza√ß√£o:** 30/09/2025 13:20 BRT  
**Pr√≥xima Revis√£o:** 07/10/2025  
**Respons√°vel:** Dev Team  

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                    FIM DO DOCUMENTO DE PEND√äNCIAS OUTUBRO 2025
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
